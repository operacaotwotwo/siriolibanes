class HubspotForm extends HTMLElement{constructor(){super(),this.containerId=this.getAttribute("container-id"),this.formId=this.getAttribute("form-id"),this.portalId=this.getAttribute("portal-id"),this.region=this.getAttribute("region"),this.eventNameSubmittedCallback=this.getAttribute("event-name-submitted-callback"),this.eventNameSubmitCallback=this.getAttribute("event-name-submit-callback"),this.eventNameSubmitValidate=this.getAttribute("event-name-submit-validate"),this.submitButtonClass=this.getAttribute("button-class"),this.maskManager=new MaskManager,this.turmaMatricula=document.querySelector("#turma_matricula")}get validations(){return JSON.parse(this.getAttribute("validations"))}get convertToText(){return JSON.parse(this.getAttribute("convert-to-text")??"[]")}get disableInputs(){return JSON.parse(this.getAttribute("disable-inputs")??"[]")}get inputLimits(){return JSON.parse(this.getAttribute("limits")??"{}")}static get observedAttributes(){return["masks"]}attributeChangedCallback(name,oldValue,newValue){if("masks"===name)try{const maskValue=JSON.parse(newValue);this.masks=Array.isArray(maskValue)?maskValue:[]}catch(e){console.error("Invalid masks attribute format. Expected a JSON string.")}}triggerCustomEvent(element,eventName,payload){const customEvent=new CustomEvent(eventName,{detail:payload});element.dispatchEvent(customEvent)}triggerAsyncCustomEvent(element,eventName,data){return new Promise((resolve,reject)=>{this.triggerCustomEvent(element,eventName,{data:data,callback:{resolve:resolve,reject:reject}})})}serializeForm(form){const formData=new FormData(form),result=[];for(let[name,value]of formData.entries())result.push({name:name,value:value});return result}findFormElement(form,selector){return form.querySelector(selector)}findFormElements(form,selector){return form.querySelectorAll(selector)}triggerChangeEvent(element){const event=new Event("change",{bubbles:!0});element.dispatchEvent(event)}connectedCallback(){const hubspotFormConfig={region:this.region,portalId:this.portalId,formId:this.formId,target:`#${this.containerId}`,css:" ",cssClass:`${this.containerId}-class`,submitButtonClass:this.submitButtonClass+` ${this.containerId}-submit`,onFormReady:form=>{const containerElement=document.querySelector(`#${this.containerId}`),formElement=form[0]||form,consentInput=document.querySelector("input[name='consentimento_legal']");consentInput&&consentInput.addEventListener("change",function(){const submitButton=document.querySelector("input[type='submit']");if(submitButton){const isChecked=this.checked;submitButton.disabled=!isChecked}});const submitBtn=this.findFormElement(formElement,`.${this.containerId}-submit`);submitBtn&&submitBtn.addEventListener("click",async event=>{event.preventDefault();const formData=this.serializeForm(formElement);formData.pop();const payloadFormData=formData.reduce((acc,current)=>(acc[current.name]=current.value,acc),{}),isValid=this.validateInputs(formElement);let isValidSubmit=!0;if(this.eventNameSubmitValidate&&isValid&&(isValidSubmit=await this.triggerAsyncCustomEvent(containerElement,this.eventNameSubmitValidate,payloadFormData)),isValid&&isValidSubmit){this.setEmailInput(formElement),this.formatPhone(formElement),this.formatCep(formElement),this.removeDisabledInputs(formElement);let isAcceptSubmit=!0;this.eventNameSubmitCallback&&(isAcceptSubmit=await this.triggerAsyncCustomEvent(containerElement,this.eventNameSubmitCallback,payloadFormData)),isAcceptSubmit&&formElement.submit()}}),this.applyMasksInForm(formElement),this.changeInputsNumberToText(formElement),this.changeDisabledInputs(formElement),this.setInputLimits(formElement)},onFormSubmitted:(form,data)=>{if(this.eventNameSubmittedCallback){const containerElement=document.querySelector(`#${this.containerId}`);this.triggerCustomEvent(containerElement,this.eventNameSubmittedCallback,{target:form,data:data})}}};if(Object.values(hubspotFormConfig).some(config=>!config))return void console.error("You need to fill in region, containerid, formid and portalid.");const container=document.createElement("div");container.id=this.containerId,this.appendChild(container);const script=document.createElement("script");"undefined"==typeof hbspt&&(script.src="//js.hsforms.net/forms/embed/v2.js",script.charset="utf-8",script.type="text/javascript"),script.onload=()=>{hbspt.forms.create(hubspotFormConfig)},document.querySelector("body").appendChild(script)}applyMasksInForm(form){!this.masks||Array.isArray(this.masks)?this.masks&&this.masks.forEach(mask=>{const input=this.findFormElement(form,`input[name="${mask.name}"]`);input&&this.maskManager.applyMask(input,mask.type)}):console.warn("Mask props is not array.")}changeInputsNumberToText(form){const inputs=this.findFormElements(form,'input[type="number"]'),convertToText=this.convertToText;inputs.forEach(input=>{const inputName=input.getAttribute("name");"number"===input.getAttribute("type")&&convertToText.includes(inputName)&&input.setAttribute("type","text")})}changeDisabledInputs(form){const inputs=this.findFormElements(form,"input"),disableInputs=this.disableInputs;inputs.forEach(input=>{const inputName=input.getAttribute("name");disableInputs.includes(inputName)&&input.setAttribute("disabled","disabled")})}removeDisabledInputs(form){this.findFormElements(form,"input").forEach(input=>{input.removeAttribute("disabled")})}validateInputs(form){let allValid=!0;for(let inputName in this.validations){let rules=this.validations[inputName],inputElement=this.findFormElement(form,`input[name=${inputName}], select[name=${inputName}], textarea[name=${inputName}]`);if(inputElement)for(let rule of rules)if(validator[rule]){if(!validator[rule](inputElement)){allValid=!1;break}}}return allValid}formatPhone(form){const phoneElement=this.findFormElement(form,'input[name="phone"], input[name="phone_number"], input[name="mobilephone"]');if(phoneElement){const phoneFormatted="+55"+phoneElement.value.replace(/([ ()-])/g,"");phoneElement.value=phoneFormatted,this.triggerChangeEvent(phoneElement)}}formatCep(form){const cepElement=this.findFormElement(form,'input[name="cep"]');if(cepElement){const cepFormatted=cepElement.value.replace(/\D/g,"");cepElement.value=cepFormatted,this.triggerChangeEvent(cepElement)}}setInputLimits(form){const inputs=this.findFormElements(form,"input"),inputLimits=this.inputLimits;inputs.forEach(input=>{const inputName=input.getAttribute("name");inputLimits[inputName]&&input.setAttribute("maxlength",inputLimits[inputName])})}setEmailInput(form){const emailInput=this.findFormElement(form,'input[name="email"]'),email=this.getAttribute("data-email");emailInput&&email&&(emailInput.value=email)}setTurmaInput(form){const turmaMatriculaInput=this.turmaMatricula,turmaInput=this.findFormElement(form,'input[name="turma_matricula"]');turmaMatriculaInput&&turmaInput&&(turmaInput.value=turmaMatriculaInput.value)}setCepInput(form){const cepMatriculaInput=this.findFormElement(form,'input[name="cep_matricula"]'),cepInput=this.findFormElement(form,'input[name="cep"]');if(cepMatriculaInput&&cepInput){const cepMatriculaFormatted=cepMatriculaInput.value.replace(/\D/g,"");cepInput.value=cepMatriculaFormatted,this.triggerChangeEvent(cepInput)}}}class MaskManager{constructor(){this.masks={phone:{pattern:"(00)00000-0000",regex:/(\d{2})(\d{5})(\d{4})/},cpf:{pattern:"000.000.000-00",regex:/(\d{3})(\d{3})(\d{3})(\d{2})/},cep:{pattern:"00000-000",regex:/(\d{5})(\d{3})/}}}formatValue(value,maskType){const cleanValue=value.replace(/\D/g,"");if(!this.masks[maskType])return value;switch(maskType){case"phone":return this.maskPhone(cleanValue);case"cpf":return cleanValue.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/,"$1.$2.$3-$4");case"cep":return cleanValue.replace(/(\d{5})(\d{3})/,"$1-$2");default:return value}}applyMask(input,type){if(!this.masks[type])return void console.warn(`Mask of type ${type} is not supported.`);const self=this;input.addEventListener("input",function(e){const cursorPosition=this.selectionStart,oldValue=this.value,newValue=self.formatValue(this.value,type);this.value=newValue,"cep"===type&&9===newValue.length&&"undefined"!=typeof validator&&validator.isCepFromCheckout&&validator.isCepFromCheckout(this,"complete");const newCursorPosition=cursorPosition+(newValue.length-oldValue.length);this.setSelectionRange(newCursorPosition,newCursorPosition)})}maskPhone(v){let r=v.replace(/\D/g,"");return r=r.replace(/^0/,""),r=r.length>10?r.replace(/^(\d\d)(\d{5})(\d{4}).*/,"($1)$2-$3"):8===r.length||9===r.length?r.replace(/^(\d\d)(\d{4})(\d{0,4}).*/,"($1)$2-$3"):r.length>2?r.replace(/^(\d\d)(\d{0,5})/,"($1)$2"):r.replace(/^(\d*)/,"($1"),r}}customElements.define("hubspot-form",HubspotForm);
//# sourceURL=https://6565290.fs1.hubspotusercontent-na1.net/hubfs/6565290/hub_generated/template_assets/1/194810330444/1763981754007/template_HubSpotForm.js